<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- 字段管理持久化层XML配置继承IFieldDao -->
<mapper namespace="com.mingsoft.cms.dao.IReservationDao">
	<sql id="column_list">
		ID,USER_NAME,PHONE_NUM,RESERVATION_DATE_BEGIN,RESERVATION_DATE_END,COMMENT,CREATE_TIME
	</sql>
	
	<!-- 表字段与实体属性对应，供返回实体信息时使用 -->
	<resultMap id="resultMapField" type="com.mingsoft.cms.entity.ReservationEntity">
		<id column="ID" property="id" />
		<result column="USER_NAME" property="userName" />
		<result column="PHONE_NUM" property="phoneNum" />
		<result column="RESERVATION_DATE_BEGIN" property="reservationDateBegin" />
		<result column="RESERVATION_DATE_END" property="reservationDateEnd" />
		<result column="COMMENT" property="comment" />
		<result column="CREATE_TIME" property="createTime" />
	</resultMap>
	


	<!-- 查询所有字段开始 -->
	<select id="queryAll" resultMap="resultMapField">
		select * from reservation;
	</select>
	<!-- 查询所有字段结束 -->
	
	
	<!-- 统计指定表单的字段数量开始 -->
	<select id="queryCountByCond" resultType="int" parameterType="com.mingsoft.cms.entity.ReservationEntity" >
		select count(*) from reservation where 1=1 
		<if test="userName !=null and userName != '' ">
			and user_name like CONCAT(CONCAT('%', #{userName}), '%')
		</if>
		<if test="phoneNum !=null and phoneNum != '' ">
			and phone_num = CONCAT(CONCAT('%', #{phoneNum}), '%')
		</if>
		<if test="reservationDateBegin !=null ">
			and reservation_date_begin &gt;= #{reservationDateBegin}
		</if>
		
		<if test="reservationDateEnd !=null ">
			and reservation_date_end &lt;= #{reservationDateEnd}
		</if>
	</select>
	<!-- 统计指定表单的字段数量结束 -->
	
	<!-- 字段列表分页查询开始 -->
	<select id="queryByPage" resultMap="resultMapField" parameterType="com.mingsoft.cms.entity.ReservationEntity">
		select * from reservation where 1=1 
		<if test="userName !=null and userName != '' ">
			and user_name like CONCAT(CONCAT('%', #{userName}), '%')
		</if>
		<if test="phoneNum !=null and phoneNum != '' ">
			and phone_num = CONCAT(CONCAT('%', #{phoneNum}), '%')
		</if>
		<if test="reservationDateBegin !=null ">
			and reservation_date_begin &gt;= #{reservationDateBegin}
		</if>
		
		<if test="reservationDateEnd !=null ">
			and reservation_date_end &lt;= #{reservationDateEnd}
		</if>
		<if test="orderBy != null">
			order by ${orderBy}
		</if>
		<if test="order == true">
			asc
		</if>
		<if test="order == false">
			desc
		</if>
		<if test="page != null">
		
		    limit ${page.pageNo*page.pageSize},#{page.pageSize}
		</if>
	</select>
	<!-- 字段列表分页查询结束 -->
	
	<!-- 增加字段实体开始 -->
	<insert id="saveEntity" parameterType="com.mingsoft.cms.entity.ReservationEntity">
		insert into reservation
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="userName != null">USER_NAME,</if>
			<if test="phoneNum != null">PHONE_NUM,</if>
			<if test="reservationDateBegin != null">RESERVATION_DATE_BEGIN,</if>
			<if test="reservationDateEnd != null">RESERVATION_DATE_END,</if>
			<if test="comment != null">COMMENT,</if>
			<if test="createTime != null">CREATE_TIME,</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="userName != null">#{userName},</if>
			<if test="phoneNum != null">#{phoneNum},</if>
			<if test="reservationDateBegin != null">#{reservationDateBegin},</if>
			<if test="reservationDateEnd != null">#{reservationDateEnd},</if>
			<if test="comment != null">#{comment}</if>
			<if test="createTime != null">#{createTime}</if>
		</trim>
	</insert>
	<!-- 增加字段实体结束 -->
	
	<!-- 删除字段实体开始 -->
	<delete id="deleteEntity" parameterType="int">
		delete from reservation where id = #{id}
	</delete>
	<!-- 删除字段实体结束 -->
		
	<!-- 查询字段实体开始 -->
	<select id="getReservationEntity" resultMap="resultMapField" parameterType="int">
		select 
			<include refid="column_list"/>
		  		from reservation where id=#{id};
	</select>
	<!-- 查询字段实体结束 -->
	
	
	<!-- 更新字段开始 -->
	<update id="updateEntity" parameterType="com.mingsoft.cms.entity.ReservationEntity">
		update reservation
		<set>
			<if test="userName != null">USER_NAME=#{userName},</if>
			<if test="phoneNum != null">PHONE_NUM=#{phoneNum},</if>
			<if test="reservationDateBegin != null">RESERVATION_DATE_BEGIN=#{reservationDateBegin},</if>
			<if test="reservationDateEnd != null">RESERVATION_DATE_END=#{reservationDateEnd},</if>
			<if test="comment != null">COMMENT=#{comment}</if>
		</set>
		where id=#{id};
	</update>
	<!-- 更新字段结束 -->
	
</mapper>